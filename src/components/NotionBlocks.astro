---
// 外部の utils.ts に頼らず、このファイル内で判定を行う安全版
const { block } = Astro.props

const type = block.Type
const content = block[type]

// テキスト抽出ヘルパー
const getRichText = (richTexts) => {
  return richTexts?.map((t) => t.plain_text).join('') || ''
}
---

<div class={`notion-block notion-${type}`}>
  {
    type === 'paragraph' ? (
      <p>{getRichText(content.rich_text)}</p>
    ) : type === 'heading_1' ? (
      <h1>{getRichText(content.rich_text)}</h1>
    ) : type === 'heading_2' ? (
      <h2>{getRichText(content.rich_text)}</h2>
    ) : type === 'heading_3' ? (
      <h3>{getRichText(content.rich_text)}</h3>
    ) : type === 'bulleted_list_item' || type === 'numbered_list_item' ? (
      <li>{getRichText(content.rich_text)}</li>
    ) : type === 'image' ? (
      <img src={content.external?.url || content.file?.url} alt="Notion Image" />
    ) : (
      /* 未対応のブロックは何も出さない */
      null
    )
  }
</div>

<style>
  .notion-block {
    margin-bottom: 1.5em;
    line-height: 1.8;
  }
  h1, h2, h3 {
    font-family: "Sawarabi Mincho", serif;
    margin-top: 2em;
  }
  p {
    margin: 0;
    min-height: 1em;
  }
  img {
    max-width: 100%;
    height: auto;
  }
</style>